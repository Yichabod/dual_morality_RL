<html>
    <head>
        <link rel="stylesheet" type="text/css" href="train.css">
        <script
          src="https://code.jquery.com/jquery-3.3.1.min.js"
          integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8="
          crossorigin="anonymous"></script>
        <script src="gridworld-task.js" type="text/javascript"></script>
        <script src="gridworld-setup.js" type="text/javascript"> </script>
        <script src="gridworld-info.js" type="text/javascript"> </script>
        <script>

            var train_data;
            function prepare_train() {   
                $.getJSON("train_data.json", function(jsondata) {
                    train_data = jsondata
                    clickStart("info7","page1")
                    run_train(train_data, GridWorldTask)
                });             
            }

            var test_data
            function prepare_test(){
                $.getJSON("test_data.json", function(jsondata) {
                    test_data = jsondata
                    clickStart("page2","page1")
                    run_test(test_data, GridWorldTask, test_group)
                });    
            }

        </script>
    </head>
    <body>
        <div id="info1"> 
            <div id="instructions">
                Welcome! Please read these instructions carefully - this will help you earn more money by doing the task right. <br>  
                <br>
                In this task you are the director of a transport station. Unfortunately the station is usually chaotic - the freight is often not where it is supposed to be.  Sometimes it might even get hit by a train. <br>
                <br>
                You have three main goals:
                <ol><b>
                <li>Try to move the freight onto its target locations</li>
                <li>Try not to let the train hit the freight</li>
                <li>Try not to let the train hit you</li></b>
                </ol>
                The better you do at achieving these goals, the more bonus payment you earn. However, it can be difficult to achieve them because you only get five moves to make in each round. <br>
            </div>
            <div id="buttonbar">
                <button type="button" id='next'; onclick="clickStart('info1','info2');"; >NEXT</button>
            </div>
        </div>

        <div id="info2" style="display:none"> 
                <div id="instructions">
                Let's begin by looking at how the freight transport station is arranged.  In each game you will see a screen like this:
                <br><br>
                <img src="assets/sample.png" id="centerimg">
                <br><br>
                This is you: <img src="assets/player.png" id="samples">
                <br><br>
                These are pieces of freight: <img src="assets/freight.png" id="samples">
                <br> 
                The one labelled <q>2</q> is more valuable, and the one labelled <q>1</q> is less valuable.
                <br><br>
                This is a train: <img src="assets/train1.png" id="samples">
                <br>
                The train's orientation tells you which way it is moving. <br><br>
                This is a switch that allows you to change the direction that the train is moving in: <img src="assets/switch.png" id="samples">
                <br> The train will turn left, or counterclockwise, each time you hit the switch.
                <br><br>
            </div>
            <div id="buttonbar">
                <button type="button" id='back'; onclick="clickStart('info2','info1');"; >BACK</button>
                <button type="button" id='next'; onclick="clickStart('info2','info3');"; >NEXT</button>
            </div>
        </div>

        <div id="info3" style="display:none"> 
            <div id="instructions">
                In order to move around the freight transfer station you can use the  up, down, left, right, and space keys. The arrow keys move you in the directions indicated.  The <b>SPACE key allows you to stay in place for one move</b>.
                <br><br>
                <img src="assets/keys.png" id="centerimg"> 
                <br><br>
                Importantly each round ends after you have made <b>5 moves</b>. 
                <br>
            </div>
            <div id="buttonbar">
                <button type="button" id='back'; onclick="clickStart('info3','info2');"; >BACK</button>
                <button type="button" id='next'; onclick="clickStart('info3','info4');pushDemo(GridWorldTask);"; >NEXT</button>
            </div>
        </div>

        <div id="info4" style="display:none"> 
            <div id="instructions">
                Your job is to <b>put valuable cargo into their target
                    locations</b> indicated by the corresponding colored squares. You can move the cargo by positioning yourself behind it and pushing it. If you move the 2 cargo onto its location you get 2 points.  If you move the 1 cargo onto its location you get 1 point.
                <br><br>
                Go ahead and give it a try!<br><br> Remember that the round ends after you finish <b>5 moves</b>. You may move on when you have achieved the maximum score or you can press n to try again.
                <br>
                
                <div id="rewardinfo4"> Reward = 0 <br/> Step = 0/5 </div>
                
                <div id="taskinfo4"></div>
                
            </div>
            <div id="buttonbar">
                <button type="button" id='back'; onclick="clearGrid('taskinfo4');clickStart('info4','info3');" >BACK</button>
                <button type="button" id='next45'; onclick="clickStart('info4','info5');"; >NEXT</button>
            </div>
        </div>

        <div id="info5" style="display:none"> 
            <div id="instructions">
                As we mentioned, there is usually a train moving through the depot.  
                You want to avoid having the train hit you or the cargo.  
                If it does you will lose points and the train will stop in its tracks.
                <br><br>
                Every time you take a step forward the train moves forward as well.  
                The only way to change the direction of the train is to move
                into the switch square.  
                This rotates the train 90 degrees clockwise.
                <br><br>
                Again, if the train hits you or the cargo then the train will stop and you will lose points.  
                <b>You lose 2 points if the train hits the "2" cargo. You lose 1 point if the train hits the "1" cargo.  
                You lose 4 points if the train hits you (and you will not be able to make any more moves during that round).</b>
                <br><br>
                Here are some examples:
                <br>
                <div id="rewardinfo5"> Reward = 0 <br/> Step = 0/5 </div>
                
                <div id="taskinfo5"></div>

            </div>
            <div id="buttonbar">
                <button type="button" id='back'; onclick="clickStart('info5','info4');"; >BACK</button>
                <button type="button" id='next'; onclick="clickStart('info5','info6');"; >NEXT</button>
            </div>
        </div>

        <div id="info6" style="display:none"> 
            <div id="instructions">
                Now, let's try practicing <b>turning the train by flipping the switch.</b>  
                There is no cargo for you to worry about here - your only job is to learn how to turn the train by hitting the switch. 
                <br><br>
                Go ahead and give it a try: <br>
                <div id="taskinfo6"></div>
            </div>
            <div id="buttonbar">
                <button type="button" id='back'; onclick="clickStart('info6','info5');"; >BACK</button>
                <button type="button" id='next'; onclick="clickStart('info6','info7');"; >NEXT</button>
            </div>
        </div>

        <div id="info7" style="display:none"> 
            <div id="instructions">
                Great, now you've learned everything you need to know.  
                Go ahead and try a couple of practice rounds before we move on to the real task:
                <br><br>
                Try practicing on 2 grids before you begin: <br>
                <div id="taskinfo7"></div>
            </div>
            <div id="buttonbar">
                <button type="button" id='back'; onclick="clickStart('info7','info6');"; >BACK</button>
                <button type="button" id='next'; onclick="prepare_train()"; >BEGIN</button>
            </div>
        </div>

        <div id="page1" style="display:none"> 
            <div id="task"></div>
            <div id="info">
                <div id="timer"></div>
                <div id="reward"> Reward = 0 <br/> Step = 0/5 </div>
                <div id="tasknum">.<br>Trial 1/90</div>
            </div>
        </div>
        <div id="page2" style="display:none">
            <p id="test_info">  </p>
            <button type="button" id='test_button'; onclick="prepare_test();"; >Start</button>
        </div>
        <div id="page3" style="display:none">
            <p> Finish! </p>
        </div>
    </body>
</html>
